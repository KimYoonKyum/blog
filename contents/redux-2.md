---
date: '2023-02-14'
title: 'Redux 체험기 - 2'
categories: ['React', 'Redux', 'Redux-toolkit']
summary: 'Redux를 쓰면서 꼭 알아야 하는 기본'
thumbnail: './redux-logo.png'
---

### 동기
- SPA 많은 상태를 관리할 필요가 생김(다시 한번, 상태란 서버응답, 캐시 데이터, 지역적으로 생성해서 사용하고 있지만 아직 서버에 저장되지않은 데이터)
- 항상 변하는 상태를 우리는 관리하기 어렵다. 어떤 모델이 다른 모델을 업데이트 하고 뷰가 어떤 모델을 업데이트 하고 등등 경우에 결국에는 제어하지 못하는 상태까지 되버린다
- 그래서 Redux는 상태 변화가 일어나는 시점에 제약을 두어 상태 변화를 예측 할 수 있도록 만들었고, 세 가지 원칙이 반영되어 있다.

### 세 가지 원칙
- 진실은 하나의 근원으로 부터
  - Redux 앱 내의 모든 상태는 하나의 저장소 안에 하나의 객체 트리 구조로 저장된다.
  - 하나의 상태 트리만 가지고 있어서 디버깅이 쉽다.
  - 하나의 상태 트리만 가지고 있어서 기능의 실행취소/다시실행(redo/undo)을 쉽게 구현할 수 있다.
- 상태는 읽기 전용이다
  - 상태를 변화시키는 방법은 무슨 일이 벌어지는지 묘사하는 액션만 객체에 전달하면된다.
  - 이를 통해서 뷰나 네트워크 콜백에서 상태를 절대 바꾸지 못하도록 한다.
  - 모든 상태는 중앙에서 관리되며 모든 액션은 엄격한 순서에 의해서 실행되기 때문에 신경을 덜 쓸 수 있다.
- 변화는 순수함수로 작성되어야한다
  - 액션에 의해서 상태 트리가 어떻게 변화하는 지를 지정하기 위해서 개발자는 순수 리듀서를 작성해야한다.
  - 리듀서는 그저 이전 상태와 액션을 받아 다음 상태를 반환하는 순수함수. 그리고 리듀서는 이전 상태를 변경하는게 아니라 새로운 객체를 반환
  - 리듀서는 앱이 커지면서 상태 트리의 특정 부분을 조작하는 더 작은 리듀서로도 나눌 수 있다.

### 용어집
- 상태
  - 상태 트리라고도 한다.
  - Redux API에서는 저장소에 의해서 관리되고 getState()에 의해 반환되는 하나의 상태값
  - 컨벤션에서는 최상위 상태는 객체나 Map 같은 key-value 컬렉션 이지만, 기술적으로는 어떤 타입이든 가능.
  - 하지만 JSON으로 변환 될 수 없는 것들은 안에 넣지 말자
- 액션
  - 상태를 변화시키려는 의도를 표한하는 객체
  - **액션은 데이터를 저장소에 넣는 유일한 방법**
  - UI 이벤트/ 네트워크 콜백 / 등등 다른 소스에서 온 모든 데이터는 액션을 통해서만 저장된다
  - 어떤 형태의 액션이 행해질지 표시하는 **'type'** 꼭 가져야한다
- 리듀서(리듀싱 함수)
  - **누적값과 값을 받아서 새로운 누적값을 반환하는 함수.** 원래 자바스크립트에 있던 개념. Array.prototype.reduce()
  - 누적값은 상태이고 누적될 값은 액션이다.
  - 리듀서는 주어진 이전 상태와 액션에서 새로운 상태를 계산한다. 반드시 순수함수이어야한다
- 디스패치 함수
  - **액션이나 비동기 액션을 받는 함수**
  - 하나나 여러개의 액션을 저장소에 보낼수도 보낼수도 있지 않는다
  - 기본 디스패치 함수는 반드시 동기적으로 저장소의 리듀서에 액션을 보내야한다.
  - 미들웨어는 기본 디스패치 함수를 감싼다. 미들웨어를 통해서 디스패치 함수는 액션뿐 아니라 비동기 액션도 처리할 수 있다.
- 액션 생산자
  - 단지 액션을 만드는 함수
  - 액션은 정보의 묶음이고 액션 생산자는 액션을 만드는 곳이니 혼동하지 말자
  - 액션 생산자를 호출하면 액션을 만들어내기만 하고 디스패치 하지는 않는다. 저장소를 업데이트 하기 위해서는 디스패치가 필요하다
  - 액션 생산자를 호출해 그 결과를 저장소 인스턴스로 바로 디스패치하는 함수를 '**바인드된 액션 생산자**'라고 한다.
- 비동기 액션
  - 디스패치 함수로 보내지는 값이지만, 아직 리듀서에게 받아들여질 준비가 안된 액션
  - 디스패치 함수로 전달되기 전에 미들웨어를 통해 액션으로 바뀌어야 한다.
- 미들웨어
  - 디스패치 함수를 결합해서 새 디스패치 함수를 반환하는 고차 함수
- 저장소
  - 앱의 상태트리를 가지고 있는 객체
  - 리듀서 수준에서 결합이 일어나기 때문에, Redux 앱에는 단 하나의 저장소만 있어야 한다
- 저장소 생성자
  - Redux 저장소를 만드는 함수

## Source

- Redux 공식 문서

  [<https://ko.redux.js.org/introduction/getting-started>](<https://ko.redux.js.org/introduction/getting-started>)